{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _bytes = _interopRequireDefault(require(\"bytes\"));\n\nvar _readFileContent = _interopRequireDefault(require(\"./utils/readFileContent\"));\n\nvar _generateId = _interopRequireDefault(require(\"./utils/generateId\"));\n\nvar Files =\n/*#__PURE__*/\nfunction (_React$Component) {\n  (0, _inherits2.default)(Files, _React$Component);\n\n  function Files() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Files);\n    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(Files).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"input\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"browseFilesPassedParams\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"id\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"validateFiles\", function (files) {\n      var _this$props = _this.props,\n          multiple = _this$props.multiple,\n          multipleMaxSize = _this$props.multipleMaxSize,\n          multipleMaxCount = _this$props.multipleMaxCount,\n          accept = _this$props.accept,\n          maxSize = _this$props.maxSize;\n      var errors = [];\n      var multipleFileSize = 0;\n\n      if (!multiple && files.length > 1) {\n        errors.push({\n          id: (0, _generateId.default)(),\n          type: \"multipleNotAllowed\"\n        });\n        return errors;\n      }\n\n      for (var index = 0; index < files.length; index++) {\n        var file = files[index];\n\n        if (Array.isArray(accept) && accept.length && accept.indexOf(file.type) === -1) {\n          errors.push({\n            id: (0, _generateId.default)(),\n            index: index,\n            file: file,\n            type: \"unsupportedFileType\"\n          });\n        } else if (maxSize) {\n          if (file.size > (0, _bytes.default)(maxSize)) {\n            errors.push({\n              id: (0, _generateId.default)(),\n              index: index,\n              file: file,\n              type: \"maxSizeExceeded\"\n            });\n          }\n        }\n\n        if (multiple) {\n          multipleFileSize += file.size;\n        }\n      }\n\n      if (multiple) {\n        if (multipleMaxSize && multipleFileSize > (0, _bytes.default)(multipleMaxSize)) {\n          errors.push({\n            id: (0, _generateId.default)(),\n            type: \"multipleMaxSizeExceeded\",\n            multipleFileSize: multipleFileSize,\n            multipleMaxSize: (0, _bytes.default)(multipleMaxSize)\n          });\n        }\n\n        if (multipleMaxCount && files.length > multipleMaxCount) {\n          errors.push({\n            id: (0, _generateId.default)(),\n            type: \"multipleMaxCountExceeded\",\n            multipleCount: files.length,\n            multipleMaxCount: multipleMaxCount\n          });\n        }\n      }\n\n      return errors;\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"processSelectedFiles\",\n    /*#__PURE__*/\n    function () {\n      var _ref = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee(eventFiles) {\n        var _this$props2, convertToBase64, onSuccess, onError, _assertThisInitialize, browseFilesPassedParams, callbacks, files, errors, i, file;\n\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(eventFiles.length === 0)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                _this$props2 = _this.props, convertToBase64 = _this$props2.convertToBase64, onSuccess = _this$props2.onSuccess, onError = _this$props2.onError;\n                _assertThisInitialize = (0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), browseFilesPassedParams = _assertThisInitialize.browseFilesPassedParams;\n                callbacks = {\n                  onSuccess: onSuccess,\n                  onError: onError\n                };\n\n                if (browseFilesPassedParams && browseFilesPassedParams.onSuccess) {\n                  callbacks.onSuccess = browseFilesPassedParams.onSuccess;\n                }\n\n                if (browseFilesPassedParams && browseFilesPassedParams.onError) {\n                  callbacks.onError = browseFilesPassedParams.onError;\n                }\n\n                files = (0, _toConsumableArray2.default)(eventFiles).map(function (file) {\n                  return {\n                    id: (0, _generateId.default)(),\n                    name: file.name,\n                    type: file.type,\n                    size: file.size,\n                    src: {\n                      file: file,\n                      base64: null\n                    }\n                  };\n                });\n                errors = _this.validateFiles(files);\n\n                if (!errors.length) {\n                  _context.next = 13;\n                  break;\n                }\n\n                callbacks.onError && callbacks.onError(errors, files);\n                _context.next = 24;\n                break;\n\n              case 13:\n                if (!convertToBase64) {\n                  _context.next = 23;\n                  break;\n                }\n\n                i = 0;\n\n              case 15:\n                if (!(i < files.length)) {\n                  _context.next = 23;\n                  break;\n                }\n\n                file = files[i].src.file;\n                _context.next = 19;\n                return (0, _readFileContent.default)(file);\n\n              case 19:\n                files[i].src.base64 = _context.sent;\n\n              case 20:\n                i++;\n                _context.next = 15;\n                break;\n\n              case 23:\n                callbacks.onSuccess && callbacks.onSuccess(files);\n\n              case 24:\n                // Reset the browseFiles arguments.\n                _this.input.value = \"\";\n                _this.browseFilesPassedParams = null;\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"onDropFilesHandler\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2(_ref2) {\n        var e, onSuccess, onError;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                e = _ref2.e, onSuccess = _ref2.onSuccess, onError = _ref2.onError;\n                _this.browseFilesPassedParams = {\n                  onSuccess: onSuccess,\n                  onError: onError\n                };\n                _context2.t0 = e.dataTransfer && e.dataTransfer.files;\n\n                if (!_context2.t0) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                _context2.next = 6;\n                return _this.processSelectedFiles(e.dataTransfer.files);\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), \"browseFilesHandler\", function (_ref4) {\n      var onSuccess = _ref4.onSuccess,\n          onError = _ref4.onError;\n      _this.browseFilesPassedParams = {\n        onSuccess: onSuccess,\n        onError: onError\n      };\n      _this.input && _this.input.click();\n    });\n    _this.input = null;\n    _this.browseFilesPassedParams = null;\n    _this.id = (0, _generateId.default)();\n    return _this;\n  }\n\n  (0, _createClass2.default)(Files, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          multiple = _this$props3.multiple,\n          accept = _this$props3.accept,\n          id = _this$props3.id;\n      return React.createElement(\"div\", null, this.props.children({\n        getLabelProps: function getLabelProps(props) {\n          return (0, _objectSpread2.default)({}, props, {\n            htmlFor: id || _this2.id\n          });\n        },\n        validateFiles: this.validateFiles,\n        browseFiles: function browseFiles() {\n          var _ref5 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n              onSuccess = _ref5.onSuccess,\n              onError = _ref5.onError;\n\n          _this2.browseFilesHandler({\n            onSuccess: onSuccess,\n            onError: onError\n          });\n        },\n        getDropZoneProps: function getDropZoneProps() {\n          var _ref6 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n              onSuccess = _ref6.onSuccess,\n              onError = _ref6.onError,\n              _onDragOver = _ref6.onDragOver,\n              _onDrop = _ref6.onDrop,\n              rest = (0, _objectWithoutProperties2.default)(_ref6, [\"onSuccess\", \"onError\", \"onDragOver\", \"onDrop\"]);\n\n          return (0, _objectSpread2.default)({}, rest, {\n            onDragOver: function onDragOver(e) {\n              e.preventDefault();\n              typeof _onDragOver === \"function\" && _onDragOver();\n            },\n            onDrop: function () {\n              var _onDrop2 = (0, _asyncToGenerator2.default)(\n              /*#__PURE__*/\n              _regenerator.default.mark(function _callee3(e) {\n                return _regenerator.default.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        e.preventDefault();\n                        typeof _onDrop === \"function\" && _onDrop();\n\n                        _this2.onDropFilesHandler({\n                          e: e,\n                          onSuccess: onSuccess,\n                          onError: onError\n                        });\n\n                      case 3:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3, this);\n              }));\n\n              function onDrop(_x3) {\n                return _onDrop2.apply(this, arguments);\n              }\n\n              return onDrop;\n            }()\n          });\n        }\n      }), React.createElement(\"input\", {\n        id: id || this.id,\n        ref: function ref(_ref7) {\n          if (_ref7) {\n            _this2.input = _ref7;\n          }\n        },\n        accept: accept,\n        style: {\n          display: \"none\"\n        },\n        type: \"file\",\n        multiple: multiple,\n        onChange: function onChange(e) {\n          return _this2.processSelectedFiles(e.target.files);\n        }\n      }));\n    }\n  }]);\n  return Files;\n}(React.Component);\n\n(0, _defineProperty2.default)(Files, \"defaultProps\", {\n  accept: [],\n  multiple: false,\n  maxSize: \"2mb\",\n  multipleMaxSize: \"10mb\",\n  multipleMaxCount: null,\n  convertToBase64: false\n});\nvar _default = Files;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}