{"ast":null,"code":"import _defineProperty from \"/Users/spencerbackman/Documents/mr-cash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport axios from 'axios';\nconst initialState = {\n  user: {\n    username: \"\"\n  },\n  authErrCode: {\n    signup: \"\",\n    login: \"\"\n  },\n  isAuthenticated: false,\n  loading: true\n};\nexport default function reducer(state = initialState, action) {\n  switch (action.type) {\n    case \"AUTHENTICATE\":\n      return _objectSpread({}, state, {}, action.user, {\n        isAuthenticated: true,\n        authErrCode: initialState.authErrCode,\n        loading: false\n      });\n\n    case \"AUTH_ERROR\":\n      return _objectSpread({}, state, {\n        authErrCode: _objectSpread({}, state.authErrCode, {\n          [action.key]: action.errCode\n        }),\n        loading: false\n      });\n\n    case \"LOGOUT\":\n      return _objectSpread({}, initialState, {\n        loading: false\n      });\n\n    default:\n      return state;\n  }\n}\nexport function authenticate(user) {\n  return {\n    type: \"AUTHENTICATE\",\n    user\n  };\n}\nexport function signup(userInfo) {\n  return dispatch => {\n    axios.post(\"/auth/signup\", userInfo).then(res => {\n      const _res$data = res.data,\n            token = _res$data.token,\n            user = _res$data.user;\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      dispatch(authenticate(user));\n    }).catch(err => {\n      dispatch(authError(\"signup\", err));\n    });\n  };\n}\nexport function login(credentials) {\n  return dispatch => {\n    axios.post(\"/auth/login\", credentials).then(res => {\n      const _res$data2 = res.data,\n            token = _res$data2.token,\n            user = _res$data2.user;\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      dispatch(authenticate(user));\n    }).catch(err => {\n      dispatch(authError(\"login\", err));\n    });\n  };\n}\nexport function logout() {\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"user\");\n  return {\n    type: \"LOGOUT\"\n  };\n}\n\nfunction authError(key, errCode) {\n  return {\n    type: \"AUTH_ERROR\",\n    key,\n    errCode\n  };\n}\n\nlet verifyAxios = axios.create();\nverifyAxios.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  config.headers.Authorization = \"Bearer \".concat(token);\n  return config;\n});\nexport function verify() {\n  return dispatch => {\n    verifyAxios.get('/profile').then(res => {\n      dispatch(authenticate(res.data.user));\n    }).catch(err => {\n      dispatch(authError(\"verify\", err.res.status));\n    });\n  };\n}","map":{"version":3,"sources":["/Users/spencerbackman/Documents/mr-cash/client/src/redux/auth.js"],"names":["axios","initialState","user","username","authErrCode","signup","login","isAuthenticated","loading","reducer","state","action","type","key","errCode","authenticate","userInfo","dispatch","post","then","res","data","token","localStorage","setItem","JSON","stringify","catch","err","authError","credentials","logout","removeItem","verifyAxios","create","interceptors","request","use","config","getItem","headers","Authorization","verify","get","status"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\nconst initialState = {\n    user: {\n        username: \"\"\n    },\n    authErrCode: {\n        signup: \"\",\n        login: \"\"\n    },\n    isAuthenticated: false,\n    loading: true\n}\n\nexport default function reducer(state = initialState, action) {\n    switch(action.type) {\n        case \"AUTHENTICATE\":\n            return {\n                ...state,\n                ...action.user,\n                isAuthenticated: true,\n                authErrCode: initialState.authErrCode,\n                loading: false\n            }\n        case \"AUTH_ERROR\":\n            return {\n                ...state,\n                authErrCode: {\n                    ...state.authErrCode,\n                    [action.key]: action.errCode\n                },\n                loading: false\n            }\n        case \"LOGOUT\":\n            return {\n                ...initialState,\n                loading: false\n            }\n        default:\n            return state;\n    }\n}\n\nexport function authenticate(user) {\n    return {\n        type: \"AUTHENTICATE\",\n        user\n    }\n}\n\nexport function signup(userInfo) {\n    return dispatch => {\n        axios.post(\"/auth/signup\", userInfo) \n            .then(res => {\n                const {token, user} = res.data\n                localStorage.setItem(\"token\", token)\n                localStorage.setItem(\"user\", JSON.stringify(user))\n                dispatch(authenticate(user))\n            }).catch(err => {\n                dispatch(authError(\"signup\", err));\n            })\n    }\n}\n\nexport function login(credentials) {  \n    return dispatch => {\n        axios.post(\"/auth/login\", credentials)\n            .then(res => {\n                const {token, user} = res.data;\n                localStorage.setItem(\"token\", token)\n                localStorage.setItem(\"user\", JSON.stringify(user))\n                dispatch(authenticate(user))\n            }).catch(err => {\n                dispatch(authError(\"login\", err));\n            })\n    }\n}\n\nexport function logout() {  \n    localStorage.removeItem(\"token\")\n    localStorage.removeItem(\"user\")\n    return {\n        type: \"LOGOUT\"\n    }\n}\n\nfunction authError(key, errCode) {  \n    return {\n        type: \"AUTH_ERROR\",\n        key,\n        errCode\n    }\n}\n\nlet verifyAxios = axios.create();\nverifyAxios.interceptors.request.use((config) => {\n    const token = localStorage.getItem('token');\n    config.headers.Authorization = `Bearer ${token}`;\n    return config;\n})\n\nexport function verify() {\n    return dispatch => {\n        verifyAxios.get('/profile')\n            .then(res => {\n                dispatch(authenticate(res.data.user))\n            }).catch(err => {\n                dispatch(authError(\"verify\", err.res.status))\n            })\n    }\n}"]},"metadata":{},"sourceType":"module"}